help:
	@echo '                                                                                             '
	@echo 'Makefile for edx-ecommerce                                                                   '
	@echo '                                                                                             '
	@echo 'Usage:                                                                                       '
	@echo '    make requirements                         install base requirements                      '
	@echo '    make test_requirements                    install test requirements                      '
	@echo '    make migrate                              apply migrations                               '
	@echo '    make serve                                start the dev server at localhost:8000         '
	@echo '    make clean                                delete generated byte code and coverage reports'
	@echo '    make test_python                          run unit tests                                 '
	@echo '    make quality                              run pep8 and pylint                            '
	@echo '    make validate_python                      run unit tests, followed by quality checks     '
	@echo '                                                                                             '

requirements:
	pip install -qr requirements/base.txt --exists-action w

test_requirements:
	pip install -qr requirements/test.txt --exists-action w

super:
	python ecommerce/manage.py createsuperuser

migrate:
	python ecommerce/manage.py migrate

serve:
	python ecommerce/manage.py runserver

clean:
	find . -name '*.pyc' -delete
	coverage erase

test_python: clean
	python ecommerce/manage.py test ecommerce --settings=settings.test --with-coverage --cover-package=ecommerce

quality:
	pep8 --config=.pep8 ecommerce
	PYTHONPATH=".:./ecommerce:$PYTHONPATH" pylint --rcfile=pylintrc ecommerce

validate_python: test_requirements test_python quality

# Targets in a Makefile which do not produce an output file with the same name as the target name
.PHONY: help requirements test_requirements super migrate serve clean test_python quality validate_python
